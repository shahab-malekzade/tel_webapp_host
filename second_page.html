<!doctype html>
<html lang="fa">
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="format-detection" content="telephone=no"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="MobileOptimized" content="176"/>
  <meta name="HandheldFriendly" content="True"/>
  <meta name="robots" content="noindex,nofollow"/>
  <title>Hello, world!</title>

  <script src="dist/js/tg_web_app.js"></script>

  <link rel="stylesheet" href="dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="asset/css/main1.css">

  <script>
		function setThemeClass() {
			document.documentElement.className = Telegram.WebApp.colorScheme;
		}

		Telegram.WebApp.onEvent('themeChanged', setThemeClass);
		setThemeClass();
  </script>

</head>

<body>

<section id="first_page">
  <p class="first-p-title">
    ฺฉ ุงุดุชุฑุงฺฉ ุงูุชุฎุงุจ ฺฉูุฏ
  </p>
  <h5 class="first-p-desc">
    ุจูุชุฑู ูพุดููุงุฏ ุฑุง ูุชูุงุณุจ ุจุง ูุงุฒ ุฎูุฏ ุงูุชุฎุงุจ ฺฉูุฏ
  </h5>

  <div class="container" id="scrollContainer">
    <div class="spacer"></div>
    <div class="item">
      <div class="card" data-index="0">
        <div class="grid">
          <div class="item-1">
            ุงุดุชุฑุงฺฉ ูพุงู
          </div>
          <div class="item-2">
            !ุฑุงฺฏุงู
          </div>
          <div class="item-3">๐ถ</div>
        </div>
        <hr>
        <p class="features">
          <span class="sticker-features">๐</span>
          <span class="plan-features">
          ฒต ูุงฺฉ ุฏุฑ ุฑูุฒ
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ฌ</span>
          <span class="plan-features">
          ฺุช ุจุง ูุงุดูุงุณ ุจู ุตูุฑุช ุดุงูุณ
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ค</span>
          <span class="plan-features">
          ูพุฑููุงู ฺฉุงุฑุจุฑ
          </span>
        </p>
        <div class="stick-bottom">
          <div class="card-button current-sub">
            <a class="purchase-link" disabled>
              ุงุดุชุฑุงฺฉ ูุนู
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="item">
      <div class="card" data-index="1">
        <div class="grid">
          <div class="item-1">
            ุงุดุชุฑุงฺฉ ุญุฑูู ุง
          </div>
          <div class="item-2">
            <p style="margin: 0;">
              <span>ฑฐ</span>
              ุชููุงู / ูุงู
            </p>
          </div>
          <div class="item-3">๐ฅ</div>
        </div>
        <hr>
        <p class="features">
          <span class="sticker-features">๐</span>
          <span class="plan-features">
          ูุงฺฉ ูุงูุญุฏูุฏ
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ฌ</span>
          <span class="plan-features">
          ฑฐฐ ฺุช ุฌุฏุฏ/ูุงู
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ค</span>
          <span class="plan-features">
          ฑฐฐ ูพุงู ุฎุตูุต ุฌุฏุฏ/ูุงู
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐</span>
          <span class="plan-features">
          ุจุจูุฏ ฺู ฺฉุณุงู ุดูุง ุฑุง ูุงฺฉ ูฺฉููุฏ
          </span>
        </p>
        <div class="stick-bottom">
          <div class="card-button">
            <a class="purchase-link" onclick="showSecondPage('professional');">
              ุงูุชุฎุงุจ
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="item">
      <div class="card" data-index="2">
        <div class="grid">
          <div class="item-1">
            ุงุดุชุฑุงฺฉ ูพุฑููู
          </div>
          <div class="item-2">
            <p style="margin: 0;">
              <span>ฑฐ</span>
              ุชููุงู / ูุงู
            </p>
          </div>
          <div class="item-3">๐ฅ</div>
        </div>
        <hr>
        <p class="features">
          <span class="sticker-features">๐</span>
          <span class="plan-features">
          ูุงฺฉ ูุงูุญุฏูุฏ
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ฌ</span>
          <span class="plan-features">
          ฑฐฐ ฺุช ุฌุฏุฏ/ูุงู
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐ค</span>
          <span class="plan-features">
          ฑฐฐ ูพุงู ุฎุตูุต ุฌุฏุฏ/ูุงู
          </span>
        </p>
        <p class="features">
          <span class="sticker-features">๐</span>
          <span class="plan-features">
          ุจุจูุฏ ฺู ฺฉุณุงู ุดูุง ุฑุง ูุงฺฉ ูฺฉููุฏ
          </span>
        </p>
        <div class="stick-bottom">
          <div class="card-button">
            <a class="purchase-link" onclick="showSecondPage('premium');">
              ุงูุชุฎุงุจ
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="spacer"></div>
  </div>

  <div class="dot-container" id="dotContainer">
    <span class="dot active" data-index="0"></span>
    <span class="dot" data-index="1"></span>
    <span class="dot" data-index="2"></span>
  </div>

</section>

<section id="second_page">
  <p class="second-p-title">
    <span id="second-p-title">ุงุดุชุฑุงฺฉ ูพุฑููู</span>
    <span class="sticker-title">๐๏ธ</span>
  </p>

  <h5 class="second-p-desc">
    ููู ุฏูุง ุงุฒ ฺุช ูุง ุฎุงุฑู ุงูุนุงุฏู ุฑุง ุจุงุฒ ฺฉูุฏุ ุฏุงุณุชุงู ุดูุง ุงุฒ ุงูุฌุง ุดุฑูุน ู ุดูุฏ.
  </h5>

  <div id="box-1" class="card card-second-page">

    <div id="triangle-1" class="triangle">
      <div style="padding: 5px;"><span>โญ</span></div>
    </div>

    <div class="grid-2">
      <div class="price">
        <p style="font-size: 10px;">
          <span style="font-size: 16px;">นถ</span>
          ุชููุงู / ูุงู
        </p>
      </div>
      <div class="interval-txt">
        ุณุงูุงูู
        <p class="card-desc">
          ุจุฑุง ฺฉ ุณุงู ฺฉุงูู ูพุฑุฏุงุฎุช ฺฉูุฏ
        </p>
      </div>
      <div class="radio-btn">
        <div class="outer-circle">
          <div id="inner-circle-1" class="inner-circle"></div>
        </div>
      </div>
    </div>

    <hr style="margin-bottom: 10px;">

    <p class="features">
      <span class="sticker-features">๐ฐ</span>
      <span class="plan-features-2">
        ุจุง ุฎุฑุฏ ุงุดุชุฑุงฺฉ ุณุงูุงูู ุงุฒ ุชุฎูู ูฺู ุจุฑุฎูุฑุฏุงุฑ ุดูุฏ
      </span>
    </p>
    <p class="features">
      <span class="sticker-features">๐</span>
      <span class="plan-features-2">
        ุงูุชุงุฒุงุช ููุญุตุฑ ุจู ูุฑุฏ ูุดุชุฑฺฉู ุณุงูุงูู ุฑุง ุขุฒุงุฏ ฺฉูุฏ
      </span>
    </p>
    <p class="features">
      <span class="sticker-features">๐ก๏ธ</span>
      <span class="plan-features-2">
        ุณุงู ุฑุง ุจุฏูู ุงูุฒุงุด ููุช ุบุฑ ููุชุธุฑู ุชุฌุฑุจู ฺฉูุฏ
      </span>
    </p>
  </div>

  <div style="height: 15px;"></div>

  <div id="box-2" class="card card-second-page">

    <div class="grid-2">
      <div class="price">
        <p style="font-size: 10px;">
          <span style="font-size: 16px;">ฑฒฐ</span>
          ุชููุงู / ูุงู
        </p>
      </div>
      <div class="interval-txt">
        ูุงูุงูู
        <p class="card-desc">
          ุจู ุตูุฑุช ูุงูุงูู ูพุฑุฏุงุฎุช ฺฉูุฏ
        </p>
      </div>
      <div class="radio-btn">
        <div class="outer-circle">
          <div id="inner-circle-2" class="inner-circle"></div>
        </div>
      </div>
    </div>

  </div>


</section>

<section id="third_page">
  <h2 class="landscape-msg">
    ูุทูุง ุตูุญู ฺฏูุด ุฎูุฏ ุฑุง ุจู ุญุงูุช ุนููุฏ ุจุฑฺฏุฑุฏุงูุฏ
  </h2>
</section>

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="dist/js/bootstrap.bundle.min.js"></script>
<script type="application/javascript">
	Telegram.WebApp.ready();

	let subscription = null;
	let interval = null;

	let first_page = document.getElementById("first_page");
	let second_page = document.getElementById("second_page");
	let third_page = document.getElementById("third_page");
	let triangle_1 = document.getElementById("triangle-1");

	let landscape = window.matchMedia("(orientation: landscape)");

	landscape.addEventListener("change", function (e) {
		if (e.matches) {
			landscapeMode();
		} else {
			portraitMode();
		}
	});

	if (window.matchMedia("(orientation: landscape)").matches) {
		landscapeMode();
	} else {
		portraitMode();
	}

	// =========================================
	// var targetObj = {};
	// var targetProxy = new Proxy(targetObj, {
	// 	set: function (target, key, value) {
	// 		target[key] = value;
	// 		console.log(`${key} set to ${value} --- ${JSON.stringify(target)}`);
	// 		return true;
	// 	}
	// });
	// targetProxy.hello_world = "test"; // console: 'hello_world set to test'

	function showMainButton() {
		Telegram.WebApp.MainButton
				.setText(
						'ุฎุฑุฏ ุงุดุชุฑุงฺฉ'
				)
				.show()
				.onClick(function () {
					console.log(`subscription/interval : ${subscription} - ${interval}`);
					Telegram.WebApp.openLink('https://google.com', {try_instant_view: true}
					);
				});
	}

	function showSecondPage(plan) {
		first_page.style.display = "none";
		second_page.style.display = "block";
		third_page.style.display = "none";

		const box1 = document.getElementById('box-1');
		const box2 = document.getElementById('box-2');

		const circle1 = document.getElementById('inner-circle-1');
		const circle2 = document.getElementById('inner-circle-2');

		if (plan === 'professional') {
			document.getElementById('second-p-title').innerHTML = 'ุงุดุชุฑุงฺฉ ุญุฑูู ุง';
			subscription = 'professional';
		} else if (plan === 'premium') {
			document.getElementById('second-p-title').innerHTML = 'ุงุดุชุฑุงฺฉ ูพุฑููู';
			subscription = 'premium';
		}

		selectDefaultInterval();

		box1.addEventListener('click', () => {
			selectDefaultInterval();
		});

		box2.addEventListener('click', () => {
			box2.classList.add('selected');
			box1.classList.remove('selected');
			circle2.classList.add('selected');
			circle1.classList.remove('selected');
			interval = 'monthly';
			triangle_1.style.display = "none";
			showMainButton();
		});

		Telegram.WebApp.BackButton
				.show()
				.onClick(function () {
					second_page.style.display = "none";
					first_page.style.display = "block";
					Telegram.WebApp.BackButton.hide();
					Telegram.WebApp.MainButton.hide();
					box1.classList.remove('selected');
					box2.classList.remove('selected');
					circle1.classList.remove('selected');
					circle2.classList.remove('selected');
					triangle_1.style.display = "none";
					subscription = null;
					interval = null;
				});

		function selectDefaultInterval() {
			box1.classList.add('selected');
			box2.classList.remove('selected');
			circle1.classList.add('selected');
			circle2.classList.remove('selected');
			interval = 'yearly';
			triangle_1.style.display = "block";
			showMainButton();
		}
	}

	function showFirstPage() {
		const box1 = document.getElementById('box-1');
		const box2 = document.getElementById('box-2');

		const circle1 = document.getElementById('inner-circle-1');
		const circle2 = document.getElementById('inner-circle-2');
		second_page.style.display = "none";
		first_page.style.display = "block";
		third_page.style.display = "none";
		Telegram.WebApp.BackButton.hide();
		Telegram.WebApp.MainButton.hide();
		box1.classList.remove('selected');
		box2.classList.remove('selected');
		circle1.classList.remove('selected');
		circle2.classList.remove('selected');
		subscription = null;
		interval = null;

	}

	function portraitMode() {
		first_page.style.display = "block";
		second_page.style.display = "none";
		// first_page.style.display = "none";
		// second_page.style.display = "block";
		third_page.style.display = "none";
		triangle_1.style.display = "none";
		Telegram.WebApp.bg_color = 'FF0000';

		let container = document.getElementById('scrollContainer');
		let dots = document.querySelectorAll('.dot');
		let cards = document.querySelectorAll('.card');

		// function scrollToIndex(index) {
		// 	let width = cards.item(0).clientWidth;
		// 	let scrollPosition = index * width;
		//
		// 	container.scrollTo({
		// 		left: scrollPosition,
		// 		behavior: 'smooth'
		// 	});
		// }

		// let scrollAmount = cards.item(0).clientWidth;
		// let scrollLeft = container.scrollLeft;
		// let index = Math.floor((scrollLeft) / scrollAmount);

		// let scrollDir = 0;
		// let startX;
		//
		// container.addEventListener('touchstart', e => {
		// 	startX = e.touches[0].clientX;
		// });
		//
		// container.addEventListener('touchmove', e => {
		// 	e.preventDefault();
		// 	scrollDir = e.touches[0].clientX > startX ? -1 : 1;
		// });
		// container.addEventListener('touchend', e => {
		// 	container.scrollLeft += scrollDir * cards.item(0).clientWidth
		// });

		function expandMode(func) {
			var timer;
			return function (event) {
				if (timer) clearTimeout(timer);
				timer = setTimeout(func, 100, event);
			};
		}

		Telegram.WebApp.sendData(`hi shahab ${Telegram.WebApp.isExpanded}`);
		window.addEventListener("resize", expandMode(function (e) {
			// Make the content place in the center of screen when Telegram.WebApp.isExpanded
			console.log(`resizeEnd: ${Telegram.WebApp.isExpanded}`);
			const newHeight = window.innerHeight;
			if (newHeight > 600) {
				document.body.style.height = `${newHeight - 50}px`;
			} else {
				document.body.style.height = null;
			}
		}));

		// container.addEventListener('scroll', function () {
		// 	scrollLeft = container.scrollLeft;
		// 	index = Math.floor((scrollLeft) / width);
		//
		// 	dots.forEach(function (dot, i) {
		// 		if (i === index) {
		// 			dot.classList.add('active');
		// 		} else {
		// 			dot.classList.remove('active');
		// 		}
		// 	});
		// });

		// dots.forEach(function (dot, i) {
		// 	dot.addEventListener('click', function () {
		// 		let index = dot.getAttribute('data-index');
		// 		scrollToIndex(index);
		// 	});
		// });
		//
		// cards.forEach(function (card, i) {
		// 	card.addEventListener('click', function () {
		// 		let index = card.getAttribute('data-index');
		// 		scrollToIndex(index);
		// 	});
		// });
	}

	function landscapeMode() {
		first_page.style.display = "none";
		second_page.style.display = "none";
		third_page.style.display = "block";
	}

</script>
</body>
</html>